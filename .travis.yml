language: node_js
node_js:
  - 10
notifications:
  slack:
    secure: NzGl8ZGdDYH0M5dnmMDK5djurdN7hXFRTGrIDJCsD8BmBA2sH2d/PS1rmtlpvQJ0SoE+1LP2ZMmnpRSKV3HhY6a5IgKPu/Tqu42YTA0MncGf377CyrMrOagaL6KFdsqxKvibRkgcux8sGZKX9ZXq59Zjb5ihgRHsUbQkXoibn+/y4zG3A7tcyfSJuNi62DO1bN31Ji56BX2mTc91iYpzb3p/KOSc0yS4NgWT3yXPzdvZuNg2zR01tzhNv92G73tyYDykLw2KBcCUkWopj1uIrFPXgFDEonQ8Qp3gVuIa8vEkh+hhyu4lPfkAB1zLQBowzrDNKdIQln5/orTVhgQIHxLvUNFFmBAGKKDscAOTKWr6mOvW6xGreVfBvhcJ+W7wwPdU3g8BtT5+85y+vCUmbiwMFWLTjSnrwjGlgBfY6GisdIa/XysrURxOyYdweG1S9/TdNRwBj8QRPrYYkb+X1M3Z9gFa3PWAIEDFgHX7SywreRfIPksRHKuYO1XGzOl5RLWgfa32733wl/cAtbwMmJmXX3kFbIQavhgmlEsKVyDqbgZwbvXD8yip3ZXRW5KavuljK6UYJwhcGql/e4tB76Qm69HtspYTFMsEzbpx1h9q41CAd4tm3ZokYxPW/cfTHJm4u5B8K0Bv6nsQInFhabnaHTzRk3WjfaFNkXZVP8E=
branches:
  only:
    - master
env:
  global:
    - secure: UK8BMHHAoumXzWn/tzMgm9cT3viX33sO2oDRnREX11drcak3e0S56Z28p6MO85ffXQ7XBINmZf395mv1ald+EUBTCvHI/j4Ik+B4SWf1isgZiAc6//6RFRBWacV8J2IZMi8TMLDaH17D6O4fx1Fg/9USQiwmkh8+Hl0gMQeEQDyBNXKhZRY5afxLN8P2pgz8SnGXpUlhPNqDi6NYgGvbKzpeN5+3X+lYbOJRz4yCIa2LDWscMJmt0+8GJpW4vqECBBi18LrlZrcVpidPZ0qofdNk8LqSQJ8cVqgg+v8RjbBJB0i3HS4B11GZghGDNWUDzTmAE6X46Iv2nArMnR13IaYygb/8t6FifxRqe3SIKiyRs0OFDZO6TUqToXTESXMATqzNWkp8T6pJuJSlzn81bC/A0T/FggkwwocnPjYQsGQpvdhCPaa5PENMSMBJxLenGjyipD6TcjaBecA9afexPRB3CbwxdKYpuP0yKvhy5phc97+TFs/btTqqsPOU0ZuHgdLek4D6S/j4qcs+ahVGWFolgt3lhal3EmslA23POtwQKUZ06Jjx9P092fi5+5Wh2PvnlPwsisDEYaZhdvYpWVLM1onlGbAgId2bMEnQ5ZVpoYwPDu7PFV8wsNPLs6p+n7XATqdQTzZ10291tM7MOyOmoksWmeg77AvFFRzJYGc=
    - secure: ekFi3Lve8RisoIZelIbhfdkPOHGAvz0mMujv0o7GYIu+yxkQM4M1aEdAO3hl0pdhU8AD6WJK/GyL2U50tXXsB2XsA4zArLjx3sjD5xqaDJ2wVAD8uw71KQmmNryGTTYFBjkDlAQJK4aYQILonT05Kk+A5F8+ozSG23m2jKoYEo3z+sQtuo9Fe03pbjUqKdOUYGBUHym3PV+qd2LQVqkPvIj953Ao7xgO21PvNNTqq63uVa+DkIKhI0trV5j506CiloSB2b8Tmo4R9afMKWv9dvGrB2S8w4/o9UCtVh7x4TWTV/9mis5BTdCwLHj30Nm5DeCjCsQCJ81tJKy0OOXE/m7GlAnvIizwUNHN2Q4MKk19F0jHkc2uhMl0mVRiRipDJnTIUbpbeLt9S3/9zCY030RFL43GD1oexJ+EP9Dimv9l3lggDx2ly5LPomPJs8miedBHo1zrFc9bmYlWVA+idFLMsuqTpt8ZOJlRU7Dts7pD0iuem4HpRGVbVqaF9OJKLzb3eiWPkcF1pDmScG4b/TP8wP+2yWD17AskdqJCIuAllmcEXyXJJICFtVQkREDqMlIK78X7pdiXHJu1UuKattAPS6fBPXblSY+/82CGrjYZkG26kg166ZoRGUDKk+IaWP74cA4+qYr2YaMkLCEpLPjXfwwjf2n/3yeiaf0JSlI=
    - secure: Vbmn1wVdvWR5GbrIgmRgbzp+0lqhq14yE12Fz2/KXmIemKCPlQj6VwEvFP/m9DC4ZEQAyX2qWOByDp3dgbMKF5e4WgZhEGcyqCiV46Mn76dAD9NGA4v6viQgO1WF+Ve2kCkjVSm7Aaj9QIcDY85NC15z3lsK5izAssFQK42CjJ7jbXIUhKoYCKLW2gASuIMltaiviQN99ZExSYc5MybvB+YS522ZxAsXp1R+9nDNNDOMxPValxDKU4uVfoRIgyomCVFENtnWIAxLr4vaKjHqPfaP3QAsaorpXVN9S23XE8TY22B24ZZ+ve/7SQZoNJ+UPSIvpc5LAFydg/vNr4W+PZsVmUXOTgzr+8toFnSbct72n6ZjEhLFSf0oBltqLyPUxhkupatqlE4FAmTGYrxOPS0IXerF1fvcvEEZgqeDbg/hkDbsRg4gUVtZfxoatnNrJCERsB4uYybGx9Km+fjRgBgokyeH7DLY2EuKpypmYzHa8nD+YoN8oRiEYK+sfMKhZgw95EK2MYi3jYdciBH2iuqrvCU5ivkZnBSzhalK/KSfCtqp+jLx7qbxh/CqQP4FKhaFQbdMHC7RiE9GYlZgNdIlmB/bHa1mjfjKR1kOz8KeQKgvMuN4GLbVlq+5BO01HzEoxKbTbH1x4peGPs7jcxu0eqoGmgue/ftDnEA/8ro=
    - secure: iMsLFljdGzoYq2ZL5+eFzZ487TAY6IJc129y6UWBW93CCHS8QfZdNq96D7L1GpNk7YtCceyNo615WwHFzR0UdK2uXwoJOC+ZN5OM6P/wIyPNIss+fsoSw8TWvunxQCG0MBhDZI0ysCzIg/Buy0xNZQYZrRGmAxV7S0hTvGtUHlFZtoPvEs9Koid+AMUld863JJsOuDDp8f1Q1rLjXRMMKooTXnkoqIyg4KSenD/22z0avjPZDdxDb/3rIr8TN1Z8CKA/v0C1+NoolSw4lPqkvOI24jd9iPTqJSuZ7xlew71err5Q9pEsjfig00OdYFVukJDm5JrUqyyaowJWJrx0NH7Oo+ENCRfnxQMHtrsWqNa40wCPFWym7ORaLzzsbITARAwHjJiR3Fr6XrgQx3m3b4Um46Bssg4LblxCyfJ+oFJqF82YrhRHK8t1YVV72UfO0JIdRCx8qijDJpIYQOtWEst84AcsiuFUVKa37m1c4XcX6ZloxOuw613FfupTTcU3WRvQMbYgnpH53gzuoVjd8LPub73bxGKYtw741C7gk5ScnwxziXCsJyCmohEQ0utwKmhHfsh7Y/jQGawvGCU6G4HEhP5PiAvOa72papuETY9IcDaQHsux8Z4/M8Sruu2uvY/hwVnWSz8RDnMtDqusvc31Rkvr3bQKiYLWxennIfE=
before_install:
  - openssl aes-256-cbc -K $encrypted_94e0b4db9dc9_key -iv $encrypted_94e0b4db9dc9_iv
    -in .env.local.enc -out .env.local -d
install:
  - echo 'Build starting...'
  - echo 'Installing Dependancies...'
  - npm install
after_success:
  - echo 'Building for production...'
  - npm run build
  - echo 'SFTP - Deleting existing deployment'
  - echo "${SFTP_KEY}" | base64 --decode >/tmp/sftp_rsa
  - curl  -k "sftp://${SFTP_HOST}:22/var/www/" --key /tmp/sftp_rsa --user "${SFTP_USER}:${SFTP_PASSWORD}" -Q "â€“RMDIR /var/www/leopard-chat" --ftp-create-dirs
  - echo 'SFTP - Deploying Build'
  - curl --ftp-create-dirs -T filename --key /tmp/sftp_rsa sftp://${SFTP_USER}:${SFTP_PASSWORD}@${SFTP_HOST}:22/var/www/leopard-chat
  - echo 'Finished'
